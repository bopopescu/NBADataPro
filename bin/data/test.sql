CREATE TABLE playertemp2013l5 as (select p.pid,SUM(TIME_TO_SEC(p.inplacetime)) as timeOnCourt,mn.startSession as startSession,count(p.mid) as matchNum,sum(p.throwin)/sum(p.throwall) as FGP,sum(p.throw3in)/sum(p.throw3all) as TPSP,sum(p.penaltyin)/sum(p.penaltyall) as FTP,sum(p.block) as BS,((sum(p.block)*sum(a.sinplacetimeA/5))/sum(time_to_sec(p.inplacetime)))/sum(b.sthrowallB-b.sthrow3allB) as BSP,sum(p.helpatt) as assist,sum(p.helpatt)/(sum(time_to_sec(p.inplacetime))/(sum(a.sinplacetimeA)/5)*sum(a.sthrowinA)-sum(p.throwin)) as assistP,sum(p.allbas) as rebound,(sum(p.allbas)*(sum(a.sinplacetimeA)/5)/TIME_TO_SEC(p.inplacetime))/sum(a.sallbasA+b.sallbasB) as reboundP,sum(p.interp) as steal,((sum(p.interp)*(sum(a.sinplacetimeA)/5))/TIME_TO_SEC(p.inplacetime))/(sum(b.sthrowallB)+0.4*sum(b.spenaltyallB)-1.07*sum(b.sattackbasB)/sum(b.sattackbasB+a.sdefencebasA)*sum(b.sthrowallB-b.sthrowinB)+1.07*sum(b.smistakeB)) as stealP,sum(p.mistake) as turnover,sum(p.mistake)/(sum(p.throwall-throwin)+0.44*sum(p.penaltyall)+sum(p.mistake)) as turnoverP,sum(p.foul) as foul,sum(p.score) as score,sum(p.attackbas) as offensive,sum(p.defencebas) as defense,sum(p.score+p.allbas+p.helpatt+p.interp+p.block)-sum(p.throwall-p.throwin)-sum(p.penaltyall-p.penaltyin)-sum(p.mistake) as effiency,sum(p.score+0.4*p.throwin-0.7*p.throwall-0.4*(p.penaltyall-p.penaltyin)+0.7*p.attackbas+0.3*p.defencebas+p.interp+0.7*p.helpatt+0.7*p.block-0.4*p.foul-p.mistake) as GmSc,sum(p.score)/(2*(sum(p.throwall)+0.44*sum(p.penaltyall))) as TSP,(sum(p.throwin)+0.5*sum(p.throw3in))/(sum(p.throwall)) as OSE,(sum(p.attackbas)*(sum(a.sinplacetimeA)/5)/TIME_TO_SEC(p.inplacetime))/sum(a.sallbasA+b.sallbasB) as OREB,(sum(p.defencebas)*(sum(a.sinplacetimeA)/5)/TIME_TO_SEC(p.inplacetime))/sum(a.sallbasA+b.sallbasB) as DREB,(sum(p.throwall+0.44*p.penaltyall+p.mistake)*(sum(a.sinplacetimeA)/5)/TIME_TO_SEC(p.inplacetime))/(sum(a.sthrowallA+0.44*a.spenaltyallA+a.smistakeA)) as utiliation,sum(p.block)/count(p.mid) as AvgBS,sum(p.helpatt)/count(p.mid) as Avgassist,sum(p.allbas)/count(p.mid) as Avgrebound,sum(p.interp)/count(p.mid) as Avgsteal,sum(p.mistake)/count(p.mid) as Avgturnover,sum(p.foul)/count(p.mid) as Avgfoul,sum(p.score)/count(p.mid) as Avgscore,sum(p.attackbas)/count(p.mid) as Avgoffensive,sum(p.defencebas)/count(p.mid) as Avgdefense,d.DD from playerscore2013l5 p,(select sum(defencebas) as sdefencebasA,sum(allbas) as sallbasA,sum(mistake) as smistakeA,sum(throwin) as sthrowinA,mid,tid,TIME_TO_SEC(inplacetime) as sinplacetimeA,sum(penaltyall) as spenaltyallA,sum(throwall) as sthrowallA from playerscore2013l5 group by mid,tid) as a,(select sum(allbas) as sallbasB,sum(attackbas) as sattackbasB,sum(throw3all) as sthrow3allB,sum(mistake) as smistakeB,sum(throwin) as sthrowinB,mid,tid,sum(penaltyall) as spenaltyallB,sum(throwall) as sthrowallB from playerscore2013l5 group by mid,tid) as b,(select v.pid,u.startSession from (select distinct pid from playerscore2013l5) as v left join (select pid,count(mid) as startSession from playerscore2013l5 where playerscore2013l5.serialid<6 group by playerscore2013l5.pid) as u on v.pid=u.pid ) as mn,(select vv.pid,ddd.DD from (select distinct pid from playerscore2013l5) as vv left join (select pid,count(mid) as DD from playerscore2013l5 where (score>10 and allbas>10)or(score>10 and helpatt>10)or(score>10 and interp>10)or(score>10 and block>10)or(allbas>10 and helpatt>10)or(allbas>10 and interp>10)or(allbas>10 and block>10)or(helpatt>10 and interp>10)or(helpatt>10 and block>10)or(interp>10 and block>10) group by pid) as ddd on vv.pid=ddd.pid) as d where p.tid=a.tid and p.mid=a.mid and p.mid=b.mid and p.tid!=b.tid and p.pid=mn.pid and p.pid=d.pid group by p.pid order by p.pid);